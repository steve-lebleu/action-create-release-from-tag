"use strict";function cov_1oy6rxftis(){var path="/var/www/github-actions/create-release-from-tag/lib/services/github.service.js";var hash="6204342a8ddbcc8465088c735b1f353a22c4a64f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/var/www/github-actions/create-release-from-tag/lib/services/github.service.js",statementMap:{"0":{start:{line:2,column:16},end:{line:10,column:1}},"1":{start:{line:3,column:28},end:{line:3,column:110}},"2":{start:{line:3,column:91},end:{line:3,column:106}},"3":{start:{line:4,column:4},end:{line:9,column:7}},"4":{start:{line:5,column:36},end:{line:5,column:97}},"5":{start:{line:5,column:42},end:{line:5,column:70}},"6":{start:{line:5,column:85},end:{line:5,column:95}},"7":{start:{line:6,column:35},end:{line:6,column:100}},"8":{start:{line:6,column:41},end:{line:6,column:73}},"9":{start:{line:6,column:88},end:{line:6,column:98}},"10":{start:{line:7,column:32},end:{line:7,column:116}},"11":{start:{line:8,column:8},end:{line:8,column:78}},"12":{start:{line:11,column:0},end:{line:11,column:62}},"13":{start:{line:12,column:0},end:{line:12,column:31}},"14":{start:{line:13,column:15},end:{line:13,column:39}},"15":{start:{line:14,column:17},end:{line:14,column:43}},"16":{start:{line:20,column:8},end:{line:20,column:27}},"17":{start:{line:21,column:8},end:{line:21,column:59}},"18":{start:{line:29,column:8},end:{line:37,column:11}},"19":{start:{line:30,column:28},end:{line:30,column:59}},"20":{start:{line:31,column:33},end:{line:35,column:14}},"21":{start:{line:36,column:12},end:{line:36,column:24}},"22":{start:{line:46,column:8},end:{line:62,column:11}},"23":{start:{line:47,column:12},end:{line:47,column:78}},"24":{start:{line:48,column:12},end:{line:48,column:90}},"25":{start:{line:49,column:28},end:{line:49,column:59}},"26":{start:{line:50,column:29},end:{line:56,column:14}},"27":{start:{line:57,column:12},end:{line:59,column:13}},"28":{start:{line:58,column:16},end:{line:58,column:84}},"29":{start:{line:60,column:12},end:{line:60,column:65}},"30":{start:{line:61,column:12},end:{line:61,column:42}},"31":{start:{line:65,column:0},end:{line:65,column:38}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:2,column:44},end:{line:2,column:45}},loc:{start:{line:2,column:89},end:{line:10,column:1}},line:2},"1":{name:"adopt",decl:{start:{line:3,column:13},end:{line:3,column:18}},loc:{start:{line:3,column:26},end:{line:3,column:112}},line:3},"2":{name:"(anonymous_2)",decl:{start:{line:3,column:70},end:{line:3,column:71}},loc:{start:{line:3,column:89},end:{line:3,column:108}},line:3},"3":{name:"(anonymous_3)",decl:{start:{line:4,column:36},end:{line:4,column:37}},loc:{start:{line:4,column:63},end:{line:9,column:5}},line:4},"4":{name:"fulfilled",decl:{start:{line:5,column:17},end:{line:5,column:26}},loc:{start:{line:5,column:34},end:{line:5,column:99}},line:5},"5":{name:"rejected",decl:{start:{line:6,column:17},end:{line:6,column:25}},loc:{start:{line:6,column:33},end:{line:6,column:102}},line:6},"6":{name:"step",decl:{start:{line:7,column:17},end:{line:7,column:21}},loc:{start:{line:7,column:30},end:{line:7,column:118}},line:7},"7":{name:"(anonymous_7)",decl:{start:{line:19,column:4},end:{line:19,column:5}},loc:{start:{line:19,column:23},end:{line:22,column:5}},line:19},"8":{name:"(anonymous_8)",decl:{start:{line:28,column:4},end:{line:28,column:5}},loc:{start:{line:28,column:40},end:{line:38,column:5}},line:28},"9":{name:"(anonymous_9)",decl:{start:{line:29,column:47},end:{line:29,column:48}},loc:{start:{line:29,column:60},end:{line:37,column:9}},line:29},"10":{name:"(anonymous_10)",decl:{start:{line:45,column:4},end:{line:45,column:5}},loc:{start:{line:45,column:34},end:{line:63,column:5}},line:45},"11":{name:"(anonymous_11)",decl:{start:{line:46,column:47},end:{line:46,column:48}},loc:{start:{line:46,column:60},end:{line:62,column:9}},line:46}},branchMap:{"0":{loc:{start:{line:2,column:16},end:{line:10,column:1}},type:"binary-expr",locations:[{start:{line:2,column:17},end:{line:2,column:21}},{start:{line:2,column:25},end:{line:2,column:39}},{start:{line:2,column:44},end:{line:10,column:1}}],line:2},"1":{loc:{start:{line:3,column:35},end:{line:3,column:109}},type:"cond-expr",locations:[{start:{line:3,column:56},end:{line:3,column:61}},{start:{line:3,column:64},end:{line:3,column:109}}],line:3},"2":{loc:{start:{line:4,column:16},end:{line:4,column:34}},type:"binary-expr",locations:[{start:{line:4,column:16},end:{line:4,column:17}},{start:{line:4,column:22},end:{line:4,column:33}}],line:4},"3":{loc:{start:{line:7,column:32},end:{line:7,column:115}},type:"cond-expr",locations:[{start:{line:7,column:46},end:{line:7,column:67}},{start:{line:7,column:70},end:{line:7,column:115}}],line:7},"4":{loc:{start:{line:8,column:51},end:{line:8,column:67}},type:"binary-expr",locations:[{start:{line:8,column:51},end:{line:8,column:61}},{start:{line:8,column:65},end:{line:8,column:67}}],line:8},"5":{loc:{start:{line:57,column:12},end:{line:59,column:13}},type:"if",locations:[{start:{line:57,column:12},end:{line:59,column:13}},{start:{line:57,column:12},end:{line:59,column:13}}],line:57}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},b:{"0":[0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6204342a8ddbcc8465088c735b1f353a22c4a64f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1oy6rxftis=function(){return actualCoverage;};}return actualCoverage;}cov_1oy6rxftis();var __awaiter=(cov_1oy6rxftis().s[0]++,(cov_1oy6rxftis().b[0][0]++,this)&&(cov_1oy6rxftis().b[0][1]++,this.__awaiter)||(cov_1oy6rxftis().b[0][2]++,function(thisArg,_arguments,P,generator){cov_1oy6rxftis().f[0]++;function adopt(value){cov_1oy6rxftis().f[1]++;cov_1oy6rxftis().s[1]++;return value instanceof P?(cov_1oy6rxftis().b[1][0]++,value):(cov_1oy6rxftis().b[1][1]++,new P(function(resolve){cov_1oy6rxftis().f[2]++;cov_1oy6rxftis().s[2]++;resolve(value);}));}cov_1oy6rxftis().s[3]++;return new((cov_1oy6rxftis().b[2][0]++,P)||(cov_1oy6rxftis().b[2][1]++,P=Promise))(function(resolve,reject){cov_1oy6rxftis().f[3]++;function fulfilled(value){cov_1oy6rxftis().f[4]++;cov_1oy6rxftis().s[4]++;try{cov_1oy6rxftis().s[5]++;step(generator.next(value));}catch(e){cov_1oy6rxftis().s[6]++;reject(e);}}function rejected(value){cov_1oy6rxftis().f[5]++;cov_1oy6rxftis().s[7]++;try{cov_1oy6rxftis().s[8]++;step(generator["throw"](value));}catch(e){cov_1oy6rxftis().s[9]++;reject(e);}}function step(result){cov_1oy6rxftis().f[6]++;cov_1oy6rxftis().s[10]++;result.done?(cov_1oy6rxftis().b[3][0]++,resolve(result.value)):(cov_1oy6rxftis().b[3][1]++,adopt(result.value).then(fulfilled,rejected));}cov_1oy6rxftis().s[11]++;step((generator=generator.apply(thisArg,(cov_1oy6rxftis().b[4][0]++,_arguments)||(cov_1oy6rxftis().b[4][1]++,[]))).next());});}));cov_1oy6rxftis().s[12]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1oy6rxftis().s[13]++;exports.GithubService=void 0;const core_1=(cov_1oy6rxftis().s[14]++,require("@actions/core"));const github_1=(cov_1oy6rxftis().s[15]++,require("@actions/github"));/**
 * @description Implements Github interactions methods
 */class GithubService{constructor(token){cov_1oy6rxftis().f[7]++;cov_1oy6rxftis().s[16]++;this.token=token;cov_1oy6rxftis().s[17]++;core_1.debug(`GithubService.token: ${this.token}`);}/**
     * @description Check if a release with the same tag alreadyExist
     *
     * @param tag
     */isExistingReleaseWithSameLabel(tag){cov_1oy6rxftis().f[8]++;cov_1oy6rxftis().s[18]++;return __awaiter(this,void 0,void 0,function*(){cov_1oy6rxftis().f[9]++;const octokit=(cov_1oy6rxftis().s[19]++,github_1.getOctokit(this.token));const releaseByTag=(cov_1oy6rxftis().s[20]++,yield octokit.rest.repos.getReleaseByTag({owner:github_1.context.repo.owner,repo:github_1.context.repo.repo,tag}));cov_1oy6rxftis().s[21]++;return true;});}/**
     * @description Create a release with tag_name and changelog as text
     *
     * @param tag
     * @param changelog
     */createRelease(tag,changelog){cov_1oy6rxftis().f[10]++;cov_1oy6rxftis().s[22]++;return __awaiter(this,void 0,void 0,function*(){cov_1oy6rxftis().f[11]++;cov_1oy6rxftis().s[23]++;core_1.debug(`#GithubService.createRelease tag supplied: ${tag}`);cov_1oy6rxftis().s[24]++;core_1.debug(`#GithubService.createRelease changelog supplied: ${changelog}`);const octokit=(cov_1oy6rxftis().s[25]++,github_1.getOctokit(this.token));const response=(cov_1oy6rxftis().s[26]++,yield octokit.rest.repos.createRelease({owner:github_1.context.repo.owner,repo:github_1.context.repo.repo,tag_name:tag,name:tag,body:changelog}));cov_1oy6rxftis().s[27]++;if(response.status!=201){cov_1oy6rxftis().b[5][0]++;cov_1oy6rxftis().s[28]++;throw new Error(`Failed to create the release: ${response.status}`);}else{cov_1oy6rxftis().b[5][1]++;}cov_1oy6rxftis().s[29]++;core_1.info(`Release created ${response.data.name}`);cov_1oy6rxftis().s[30]++;return response.data.html_url;});}}cov_1oy6rxftis().s[31]++;exports.GithubService=GithubService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdpdGh1Yi5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsImFkb3B0IiwidmFsdWUiLCJyZXNvbHZlIiwiUHJvbWlzZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInN0ZXAiLCJuZXh0IiwiZSIsInJlamVjdGVkIiwicmVzdWx0IiwiZG9uZSIsInRoZW4iLCJhcHBseSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsIkdpdGh1YlNlcnZpY2UiLCJjb3JlXzEiLCJyZXF1aXJlIiwiZ2l0aHViXzEiLCJjb25zdHJ1Y3RvciIsInRva2VuIiwiZGVidWciLCJpc0V4aXN0aW5nUmVsZWFzZVdpdGhTYW1lTGFiZWwiLCJ0YWciLCJvY3Rva2l0IiwiZ2V0T2N0b2tpdCIsInJlbGVhc2VCeVRhZyIsInJlc3QiLCJyZXBvcyIsImdldFJlbGVhc2VCeVRhZyIsIm93bmVyIiwiY29udGV4dCIsInJlcG8iLCJjcmVhdGVSZWxlYXNlIiwiY2hhbmdlbG9nIiwicmVzcG9uc2UiLCJ0YWdfbmFtZSIsIm5hbWUiLCJib2R5Iiwic3RhdHVzIiwiRXJyb3IiLCJpbmZvIiwiZGF0YSIsImh0bWxfdXJsIl0sIm1hcHBpbmdzIjoiQUFBQSxhLCtsTEFlWTsyRkFkWixHQUFJQSxDQUFBQSxTQUFTLDBCQUFJLCtEQUFRLEtBQUtBLFNBQWIsQ0FBRCw4QkFBNEIsU0FBVUMsT0FBVixDQUFtQkMsVUFBbkIsQ0FBK0JDLENBQS9CLENBQWtDQyxTQUFsQyxDQUE2Qyx5QkFDckYsUUFBU0MsQ0FBQUEsS0FBVCxDQUFlQyxLQUFmLENBQXNCLGlEQUFFLE1BQU9BLENBQUFBLEtBQUssV0FBWUgsQ0FBQUEsQ0FBakIsNkJBQXFCRyxLQUFyQiw4QkFBNkIsR0FBSUgsQ0FBQUEsQ0FBSixDQUFNLFNBQVVJLE9BQVYsQ0FBbUIsaURBQUVBLE9BQU8sQ0FBQ0QsS0FBRCxDQUFQLENBQWlCLENBQTVDLENB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d2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuR2l0aHViU2VydmljZSA9IHZvaWQgMDtcbmNvbnN0IGNvcmVfMSA9IHJlcXVpcmUoXCJAYWN0aW9ucy9jb3JlXCIpO1xuY29uc3QgZ2l0aHViXzEgPSByZXF1aXJlKFwiQGFjdGlvbnMvZ2l0aHViXCIpO1xuLyoqXG4gKiBAZGVzY3JpcHRpb24gSW1wbGVtZW50cyBHaXRodWIgaW50ZXJhY3Rpb25zIG1ldGhvZHNcbiAqL1xuY2xhc3MgR2l0aHViU2VydmljZSB7XG4gICAgY29uc3RydWN0b3IodG9rZW4pIHtcbiAgICAgICAgdGhpcy50b2tlbiA9IHRva2VuO1xuICAgICAgICBjb3JlXzEuZGVidWcoYEdpdGh1YlNlcnZpY2UudG9rZW46ICR7dGhpcy50b2tlbn1gKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIENoZWNrIGlmIGEgcmVsZWFzZSB3aXRoIHRoZSBzYW1lIHRhZyBhbHJlYWR5RXhpc3RcbiAgICAgKlxuICAgICAqIEBwYXJhbSB0YWdcbiAgICAgKi9cbiAgICBpc0V4aXN0aW5nUmVsZWFzZVdpdGhTYW1lTGFiZWwodGFnKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBvY3Rva2l0ID0gZ2l0aHViXzEuZ2V0T2N0b2tpdCh0aGlzLnRva2VuKTtcbiAgICAgICAgICAgIGNvbnN0IHJlbGVhc2VCeVRhZyA9IHlpZWxkIG9jdG9raXQucmVzdC5yZXBvcy5nZXRSZWxlYXNlQnlUYWcoe1xuICAgICAgICAgICAgICAgIG93bmVyOiBnaXRodWJfMS5jb250ZXh0LnJlcG8ub3duZXIsXG4gICAgICAgICAgICAgICAgcmVwbzogZ2l0aHViXzEuY29udGV4dC5yZXBvLnJlcG8sXG4gICAgICAgICAgICAgICAgdGFnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiBDcmVhdGUgYSByZWxlYXNlIHdpdGggdGFnX25hbWUgYW5kIGNoYW5nZWxvZyBhcyB0ZXh0XG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGFnXG4gICAgICogQHBhcmFtIGNoYW5nZWxvZ1xuICAgICAqL1xuICAgIGNyZWF0ZVJlbGVhc2UodGFnLCBjaGFuZ2Vsb2cpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvcmVfMS5kZWJ1ZyhgI0dpdGh1YlNlcnZpY2UuY3JlYXRlUmVsZWFzZSB0YWcgc3VwcGxpZWQ6ICR7dGFnfWApO1xuICAgICAgICAgICAgY29yZV8xLmRlYnVnKGAjR2l0aHViU2VydmljZS5jcmVhdGVSZWxlYXNlIGNoYW5nZWxvZyBzdXBwbGllZDogJHtjaGFuZ2Vsb2d9YCk7XG4gICAgICAgICAgICBjb25zdCBvY3Rva2l0ID0gZ2l0aHViXzEuZ2V0T2N0b2tpdCh0aGlzLnRva2VuKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0geWllbGQgb2N0b2tpdC5yZXN0LnJlcG9zLmNyZWF0ZVJlbGVhc2Uoe1xuICAgICAgICAgICAgICAgIG93bmVyOiBnaXRodWJfMS5jb250ZXh0LnJlcG8ub3duZXIsXG4gICAgICAgICAgICAgICAgcmVwbzogZ2l0aHViXzEuY29udGV4dC5yZXBvLnJlcG8sXG4gICAgICAgICAgICAgICAgdGFnX25hbWU6IHRhZyxcbiAgICAgICAgICAgICAgICBuYW1lOiB0YWcsXG4gICAgICAgICAgICAgICAgYm9keTogY2hhbmdlbG9nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT0gMjAxKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIHRoZSByZWxlYXNlOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvcmVfMS5pbmZvKGBSZWxlYXNlIGNyZWF0ZWQgJHtyZXNwb25zZS5kYXRhLm5hbWV9YCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5odG1sX3VybDtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZXhwb3J0cy5HaXRodWJTZXJ2aWNlID0gR2l0aHViU2VydmljZTtcbiJdfQ==